<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>pandas - 전처리 추가 내용</title>
  <meta name="description" content="목차">
  
  <meta name="author" content="Manjoong Kim">
  <meta name="copyright" content="&copy; Manjoong Kim 2021">
  

  <!-- External libraries -->
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/monokai-sublime.min.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/lightbox2/2.7.1/css/lightbox.css">

  <!-- Favicon and other icons (made with http://www.favicon-generator.org/) -->
  <link rel="shortcut icon" href="/assets/icons/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/assets/icons/favicon.ico" type="image/x-icon">
  <link rel="apple-touch-icon" sizes="57x57" href="/assets/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/assets/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/assets/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/assets/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/assets/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/assets/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/assets/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/assets/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="/assets/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/assets/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/icons/favicon-16x16.png">
  <link rel="manifest" href="/assets/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/assets/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">

  
  <!-- Facebook OGP cards -->
  <meta property="og:description" content="목차" />
  <meta property="og:url" content="http://localhost:4000/python/2020/09/28/python-df4.html">
  <meta property="og:site_name" content="RWDR" />
  <meta property="og:title" content="pandas - 전처리 추가 내용" />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="http://localhost:4000/assets/RWDR.png" />
  <meta property="og:image:type" content="image/png" />
  <meta property="og:image:width" content="612" />
  <meta property="og:image:height" content="605" />
  

  
  <!-- Twitter: card tags -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="pandas - 전처리 추가 내용">
  <meta name="twitter:description" content="목차">
  <meta name="twitter:image" content="http://localhost:4000/assets/RWDR.png">
  <meta name="twitter:url" content="http://localhost:4000/python/2020/09/28/python-df4.html">
  

  

  <!-- Site styles -->
  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://localhost:4000/python/2020/09/28/python-df4.html">
	<link rel="alternate" type="application/rss+xml" title="RWDR" href="http://localhost:4000/feed.xml" />
	
	<!-- Tooltips -->
	<script type="text/javascript">
		window.tooltips = []
	</script>
</head>


  <body>

    <header class="navigation" role="banner">
  <div class="navigation-wrapper">
    <a href="/" class="logo">
      
      <img src="/assets/RWDR.png" alt="RWDR">
      
    </a>
    <a href="javascript:void(0)" class="navigation-menu-button" id="js-mobile-menu">
      <i class="fa fa-bars"></i>
    </a>
    <nav role="navigation">
      <ul id="js-navigation-menu" class="navigation-menu show">
				
	
	<li class="nav-link"><a href="/about/">About</a>
	

	

	

	
	<li class="nav-link"><a href="/posts/">Posts</a>
	

	

	
	<li class="nav-link"><a href="/search/">Search</a>
	

	
	<li class="nav-link"><a href="/typography/">Plan</a>
	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	


      </ul>
    </nav>
  </div>
</header>


    <div class="page-content">
        <div class="post">

<div class="post-header-container " >
  <div class="scrim ">
    <header class="post-header">
      <h1 class="title">pandas - 전처리 추가 내용</h1>
      <p class="info">by <strong>Kim</strong></p>
    </header>
  </div>
</div>

<div class="wrapper">

 <span class="page-divider">
  <span class="one"></span>
  <span class="two"></span>
</span>
 

<section class="post-meta">
  <div class="post-date">September 28, 2020</div>
  <div class="post-categories">
  in 
    
    <a href="/category/python">Python</a>
    
  
  </div>
</section>

<article class="post-content">
  <h2 id="목차">목차</h2>

<ul>
  <li><a href="#dfstack">1. 스택&amp;언스택</a>
    <ul>
      <li><a href="#unstack">1) 언스택(unstack)</a></li>
      <li><a href="#stack">2) 스택(stack)</a></li>
    </ul>
  </li>
  <li><a href="#dfrank">2. 순위(rank)</a></li>
  <li><a href="#merge">3. 병합(merge)</a></li>
  <li><a href="#pivot">4. 피벗 테이블(pivot)</a></li>
  <li><a href="#panstr">5. str 모듈</a></li>
  <li><a href="#dfdup">6. 중복 처리 메소드(duplicate)</a></li>
</ul>

<p><br /></p>

<hr />

<h3 id="dfstack">1. 스택&amp;언스택(stack)</h3>

<p>pandas 내에 있는 메소드 <code class="highlighter-rouge">stack</code>과 <code class="highlighter-rouge">unstack</code>은 R에서 <code class="highlighter-rouge">reshape2 패키지</code>의 함수 <code class="highlighter-rouge">melt</code>, <code class="highlighter-rouge">dcast</code>와 동일한 기능을 가지고 있습니다. 두 함수를 다루기 전에 Wide data와 long data를 알아야 하는데 이 둘에 대한 간단한 설명은 아래 접기 버튼에 수록해놓았습니다. 관련 글마다 이 둘을 지칭하는 용어가 약간씩 다르지만 다루는 개념에는 차이가 없고 구글링을 할 때 지장 있을 정도의 변화가 없습니다. 내용 숙지 후 바로 메소드 사용으로 넘어가봅시다.</p>

<details>
<summary>Wide data &amp; long data</summary>
1. Wide data

- 교차 테이블

- 행별, 컬럼별 그룹연산 수행가능하고 조인 연산이 불가능합니다.

<fieldset>
<pre>지점   1  2  3  4</pre>
<pre> A    10 11 12 13</pre>
<pre> B    14 15 16 17</pre>
<pre> C    18 19 20 21</pre>
​<pre> D    22 23 24 25</pre>
</fieldset>

2. Long data

- DB, 모델 분석에서 선호하는 방식

- 새로운 데이터(관찰대상)에 대한 추가가 비교적 용이

- group by, JOIN 연산 가능

<fieldset>
<pre>지점 분기 판매량</pre>
<pre> A    1    10</pre>
<pre> A    2    11</pre>
<pre> ...</pre>
​<pre>D    4    25 </pre>
</fieldset>

<br />

</details>

<p><br /></p>

<h4 id="unstack">1. 언스택(unstack)</h4>

<p>unstack은 <code class="highlighter-rouge">long data</code>를 <code class="highlighter-rouge">wide data</code> 로 바꿔줍니다. 즉, 멀티 인덱스를 멀티 컬럼으로 바꾸는 메소드입니다. 옵션에서의 계층(level) 기본값이 -1이기 때문에 레벨을 지정해주지 않으면 가장 하위 레벨의 index를 컬럼화합니다.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1"># 멀티 인덱스를 가진 시리즈 생성
</span><span class="n">s1</span> <span class="o">=</span> <span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span><span class="n">index</span><span class="o">=</span><span class="p">[[</span><span class="s">'A'</span><span class="p">,</span><span class="s">'A'</span><span class="p">,</span><span class="s">'B'</span><span class="p">,</span><span class="s">'B'</span><span class="p">],[</span><span class="s">'a'</span><span class="p">,</span><span class="s">'b'</span><span class="p">,</span><span class="s">'a'</span><span class="p">,</span><span class="s">'b'</span><span class="p">]])</span>
<span class="n">s1</span>
<span class="n">Out</span><span class="p">:</span>
<span class="n">A</span>  <span class="n">a</span>    <span class="mi">1</span>
   <span class="n">b</span>    <span class="mi">2</span>
<span class="n">B</span>  <span class="n">a</span>    <span class="mi">3</span>
   <span class="n">b</span>    <span class="mi">4</span>

<span class="n">s1</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>
<span class="n">Out</span><span class="p">:</span>
  <span class="n">a</span> <span class="n">b</span>
<span class="n">A</span> <span class="mi">1</span> <span class="mi">2</span>
<span class="n">B</span> <span class="mi">3</span> <span class="mi">4</span>

<span class="n">s1</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">Out</span><span class="p">:</span>
  <span class="n">A</span> <span class="n">B</span>
<span class="n">a</span> <span class="mi">1</span> <span class="mi">3</span>
<span class="n">b</span> <span class="mi">2</span> <span class="mi">4</span></code></pre></figure>

<h4 id="stack">2. 스택(stack)</h4>

<p>stack은 <code class="highlighter-rouge">wide data</code>를 <code class="highlighter-rouge">long data</code>로 바꿔줍니다. 즉, 멀티 컬럼을 멀티 인덱스로 바꾸는 메소디입니다. unstack처럼 옵션 level의 기본값이 -1이기 때문에 레벨을 지정하지 않으면 가장 하위 레벨의 index를 컬럼화합니다.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1"># 위 코드에서 사용한 s1 사용
</span><span class="n">s2</span> <span class="o">=</span> <span class="n">s1</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">s2</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span>
<span class="n">Out</span><span class="p">:</span>
<span class="n">a</span> <span class="n">A</span> <span class="mi">1</span>
  <span class="n">B</span> <span class="mi">3</span>
<span class="n">b</span> <span class="n">A</span> <span class="mi">2</span>
  <span class="n">B</span> <span class="mi">4</span>

<span class="n">s2</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">Out</span><span class="p">:</span>
<span class="n">a</span> <span class="n">A</span> <span class="mi">1</span>
  <span class="n">B</span> <span class="mi">3</span>
<span class="n">b</span> <span class="n">A</span> <span class="mi">2</span>
  <span class="n">B</span> <span class="mi">4</span>


<span class="c1"># (+) dropna 옵션 : NaN값을 생략하는 옵션, 기본값은 True
</span>
<span class="err">​</span><span class="n">s2</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s">'b'</span><span class="p">,</span><span class="s">'B'</span><span class="p">]</span> <span class="o">=</span> <span class="n">NA</span>

<span class="n">s2</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span>
<span class="n">Out</span><span class="p">:</span>
<span class="n">a</span> <span class="n">A</span> <span class="mf">1.0</span>
  <span class="n">B</span> <span class="mf">3.0</span>
<span class="n">b</span> <span class="n">A</span> <span class="mf">2.0</span>

<span class="n">s2</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">dropna</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">Out</span><span class="p">:</span>
<span class="n">a</span> <span class="n">A</span> <span class="mf">1.0</span>
  <span class="n">B</span> <span class="mf">3.0</span>
<span class="n">b</span> <span class="n">A</span> <span class="mf">2.0</span>
  <span class="n">B</span> <span class="n">NaN</span>  </code></pre></figure>

<p><br /></p>

<hr />

<h4 id="dfrank">2. rank </h4>

<p>rank 메소드는 변수 내에 있는 value들을 크기에 따라 순위를 부여하는 메소드입니다. 간단한 문법으로 구성되어 있고 순위 부여시 value의 크기가 같아 순위가 같아지는 값들에 대한 순위 부여 방법(method)을 바꾸는 옵션만 업무에 따라 바꿔주시면 됩니다.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">s1</span><span class="o">.</span><span class="n">rank</span><span class="p">(</span>
<span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>           <span class="c1"># 축 번호, 순위 부여 방향 선택
</span><span class="n">method</span><span class="o">=</span><span class="p">{</span><span class="s">'average'</span> <span class="c1"># 동순위에 대한 평균 값 출력
</span>        <span class="s">'min'</span><span class="p">,</span>    <span class="c1"># 동순위에 대한 작은 값 출력
</span>        <span class="s">'max'</span><span class="p">,</span>    <span class="c1"># 동순위에 대한 큰 값 출력(서로 같은 순위 부여)
</span>        <span class="s">'first'</span><span class="p">},</span> <span class="c1"># 동순위중 가장 먼저 배치된 값에 높은 순위(서로 다른 순위 부여)
</span><span class="n">ascending</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>   <span class="c1"># 오름차순 방향</span></code></pre></figure>

<p><br /></p>

<p>크게 어려운 내용이 없으니 가벼운 예제들을 보고 습득합시다.</p>

<ul>
  <li>시리즈에 rank 메소드 적용</li>
</ul>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">s1</span> <span class="o">=</span> <span class="n">Series</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="n">s2</span> <span class="o">=</span> <span class="n">Series</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>

<span class="n">s1</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>
<span class="n">Out</span><span class="p">:</span>
<span class="mi">0</span> <span class="mf">5.0</span>
<span class="mi">1</span> <span class="mf">2.0</span>
<span class="mi">2</span> <span class="mf">3.0</span>
<span class="mi">3</span> <span class="mf">1.0</span>
<span class="mi">4</span> <span class="mf">4.0</span>

<span class="n">s2</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>
<span class="n">Out</span><span class="p">:</span>
<span class="mi">0</span> <span class="mf">6.0</span>
<span class="mi">1</span> <span class="mf">3.0</span>
<span class="mi">2</span> <span class="mf">4.0</span>
<span class="mi">3</span> <span class="mf">1.5</span>
<span class="mi">4</span> <span class="mf">1.5</span>
<span class="mi">5</span> <span class="mf">5.0</span>

<span class="n">s2</span><span class="o">.</span><span class="n">rank</span><span class="p">(</span><span class="n">method</span> <span class="o">=</span> <span class="s">'min'</span><span class="p">)</span>
<span class="n">Out</span><span class="p">:</span>
<span class="mi">0</span> <span class="mf">6.0</span>
<span class="mi">1</span> <span class="mf">3.0</span>
<span class="mi">2</span> <span class="mf">4.0</span>
<span class="mi">3</span> <span class="mf">1.0</span>
<span class="mi">4</span> <span class="mf">1.0</span>
<span class="mi">5</span> <span class="mf">5.0</span>

<span class="n">s2</span><span class="o">.</span><span class="n">rank</span><span class="p">(</span><span class="n">method</span> <span class="o">=</span> <span class="s">'max'</span><span class="p">)</span>
<span class="n">Out</span><span class="p">:</span>
<span class="mi">0</span> <span class="mf">6.0</span>
<span class="mi">1</span> <span class="mf">3.0</span>
<span class="mi">2</span> <span class="mf">4.0</span>
<span class="mi">3</span> <span class="mf">2.0</span>
<span class="mi">4</span> <span class="mf">2.0</span>
<span class="mi">5</span> <span class="mf">5.0</span>

<span class="n">s2</span><span class="o">.</span><span class="n">rank</span><span class="p">(</span><span class="n">method</span> <span class="o">=</span> <span class="s">'first'</span><span class="p">)</span>
<span class="n">Out</span><span class="p">:</span>
<span class="mi">0</span> <span class="mf">6.0</span>
<span class="mi">1</span> <span class="mf">3.0</span>
<span class="mi">2</span> <span class="mf">4.0</span>
<span class="mi">3</span> <span class="mf">1.0</span>
<span class="mi">4</span> <span class="mf">2.0</span>
<span class="mi">5</span> <span class="mf">5.0</span></code></pre></figure>

<p><br /></p>

<ul>
  <li>데이터 프레임에 rank 메소드 적용 (순위 축 방향)</li>
</ul>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">df1</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">({</span><span class="s">'col1'</span><span class="p">:[</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="s">'col2'</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]})</span>

<span class="n">df1</span><span class="o">.</span><span class="n">rank</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">Out</span><span class="p">:</span>
   <span class="n">col1</span> <span class="n">col2</span>
<span class="mi">0</span>  <span class="mf">3.0</span>   <span class="mf">1.0</span>
<span class="mi">1</span>  <span class="mf">1.0</span>   <span class="mf">2.0</span>
<span class="mi">2</span>  <span class="mf">2.0</span>   <span class="mf">3.0</span>
<span class="mi">3</span>  <span class="mf">4.0</span>   <span class="mf">4.0</span>

<span class="n">df1</span><span class="o">.</span><span class="n">rank</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">Out</span><span class="p">:</span>
   <span class="n">col1</span> <span class="n">col2</span>
<span class="mi">0</span>  <span class="mf">2.0</span>   <span class="mf">1.0</span>
<span class="mi">1</span>  <span class="mf">1.0</span>   <span class="mf">2.0</span>
<span class="mi">2</span>  <span class="mf">1.5</span>   <span class="mf">1.5</span>
<span class="mi">3</span>  <span class="mf">2.0</span>   <span class="mf">1.0</span></code></pre></figure>

<hr />

<h3 id="merge">3. 병합(merge) </h3>

<p>merge 메소드는 SQL에서의 JOIN과 비슷한 기능을 하는 메소드입니다. JOIN이 특정 속성에 대해서 두 테이블을 붙이는 것처럼 merge는 두 데이터 프레임을 특정 속성에 대해서 붙여줍니다. 비슷한 기능이라는 것은 merge 메소드는 JOIN에 비해 기능이 약하기 때문입니다. JOIN과 달리 merge는 NON EQUI JOIN이 불가능합니다. 또, JOIN이 여러 개의 테이블을 묶을 수 있는 데 반면 merge는 두 개의 데이터 프레임만 붙일 수 있습니다. 그래도 다행히 INNER JOIN, OUTER JOIN은 모두 가능합니다.</p>

<table>
  <thead>
    <tr>
      <th> </th>
      <th style="text-align: center">JOIN</th>
      <th style="text-align: center">merge</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>EQUI JOIN</td>
      <td style="text-align: center">가능</td>
      <td style="text-align: center">가능</td>
    </tr>
    <tr>
      <td>NON EQUI JOIN</td>
      <td style="text-align: center">가능</td>
      <td style="text-align: center">불가능</td>
    </tr>
    <tr>
      <td>붙이는 자료 수</td>
      <td style="text-align: center">제한 없음</td>
      <td style="text-align: center">2개</td>
    </tr>
    <tr>
      <td>INNER JOIN</td>
      <td style="text-align: center">가능</td>
      <td style="text-align: center">가능</td>
    </tr>
    <tr>
      <td>OUTER JOIN</td>
      <td style="text-align: center">가능</td>
      <td style="text-align: center">가능</td>
    </tr>
    <tr>
      <td>같은 인덱스에 대해 결합</td>
      <td style="text-align: center">미지원(변수 추가 필요)</td>
      <td style="text-align: center">가능</td>
    </tr>
  </tbody>
</table>

<p><br /></p>

<p>간단히 문법을 살펴본 후 예제를 보도록 하겠습니다. JOIN에 대한 개념이 부족하신 분은 코드를 보아도 이해하기 어려우니 SQL에서 JOIN 다루는 글을 봐주시면 도움이 될 것입니다.</p>

<p>문법</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
<span class="n">left</span><span class="p">,</span>   <span class="c1"># 첫 번째 데이터 프레임
</span><span class="n">right</span><span class="p">,</span>  <span class="c1"># 두 번째 데이터 프레임
</span>
<span class="n">how</span><span class="o">=</span> <span class="p">{</span><span class="s">'left'</span><span class="p">,</span>  <span class="c1"># LEFT (OUTER) JOIN
</span>     <span class="s">'right'</span><span class="p">,</span>  <span class="c1"># RIGHT (OUTER) JOIN
</span>     <span class="s">'outer'</span><span class="p">,</span>  <span class="c1"># FULL OUTER JOIN
</span>     <span class="s">'inner'</span><span class="p">},</span> <span class="c1"># INNER JOIN (기본 값)
</span>
<span class="n">on</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>       <span class="c1"># 조인할 컬럼 이름
</span><span class="p">(</span>
<span class="n">left_on</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>  <span class="c1"># 첫 번째 데이터 프레임의 컬럼 이름
</span><span class="n">right_on</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="c1"># 두 번째 데이터 프레임의 컬럼 이름
</span><span class="p">)</span>

<span class="n">left_index</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="c1"># 왼쪽 데이터 (첫번째) index 값으로 조인 여부
</span><span class="n">right_index</span><span class="o">=</span><span class="bp">False</span> <span class="c1"># 오른쪽 데이터(두번째) index 값으로 조인 여부
</span><span class="p">)</span></code></pre></figure>

<p>예제</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">df1</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">({</span><span class="s">'col1'</span><span class="p">:[</span><span class="s">'a'</span><span class="p">,</span><span class="s">'b'</span><span class="p">,</span><span class="s">'c'</span><span class="p">],</span>
                 <span class="s">'col2'</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]})</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">({</span><span class="s">'col11'</span><span class="p">:[</span><span class="s">'a'</span><span class="p">,</span><span class="s">'b'</span><span class="p">,</span><span class="s">'d'</span><span class="p">],</span>
                 <span class="s">'col22'</span><span class="p">:[</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">]})</span>

<span class="c1"># INNER JOIN
</span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span><span class="n">df2</span><span class="p">,</span> <span class="n">left_on</span> <span class="o">=</span> <span class="s">'col1'</span><span class="p">,</span> <span class="n">right_on</span> <span class="o">=</span> <span class="s">'col11'</span><span class="p">)</span>
<span class="n">Out</span><span class="p">:</span>
  <span class="n">col1</span>  <span class="n">col2</span> <span class="n">col11</span>  <span class="n">col22</span>
<span class="mi">0</span>    <span class="n">a</span>     <span class="mi">1</span>     <span class="n">a</span>     <span class="mi">10</span>
<span class="mi">1</span>    <span class="n">b</span>     <span class="mi">2</span>     <span class="n">b</span>     <span class="mi">20</span>

<span class="c1"># LEFT JOIN
</span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span><span class="n">df2</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span> <span class="s">'left'</span><span class="p">,</span> <span class="n">left_on</span> <span class="o">=</span> <span class="s">'col1'</span><span class="p">,</span> <span class="n">right_on</span> <span class="o">=</span> <span class="s">'col11'</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">9</span><span class="p">]:</span> 
  <span class="n">col1</span>  <span class="n">col2</span> <span class="n">col11</span>  <span class="n">col22</span>
<span class="mi">0</span>    <span class="n">a</span>     <span class="mi">1</span>     <span class="n">a</span>   <span class="mf">10.0</span>
<span class="mi">1</span>    <span class="n">b</span>     <span class="mi">2</span>     <span class="n">b</span>   <span class="mf">20.0</span>
<span class="mi">2</span>    <span class="n">c</span>     <span class="mi">3</span>   <span class="n">NaN</span>    <span class="n">NaN</span>

<span class="c1"># RIGHT JOIN
</span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span><span class="n">df2</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span> <span class="s">'right'</span><span class="p">,</span> <span class="n">left_on</span> <span class="o">=</span> <span class="s">'col1'</span><span class="p">,</span> <span class="n">right_on</span> <span class="o">=</span> <span class="s">'col11'</span><span class="p">)</span>
<span class="n">Out</span><span class="p">:</span> 
  <span class="n">col1</span>  <span class="n">col2</span> <span class="n">col11</span>  <span class="n">col22</span>
<span class="mi">0</span>    <span class="n">a</span>   <span class="mf">1.0</span>     <span class="n">a</span>     <span class="mi">10</span>
<span class="mi">1</span>    <span class="n">b</span>   <span class="mf">2.0</span>     <span class="n">b</span>     <span class="mi">20</span>
<span class="mi">2</span>  <span class="n">NaN</span>   <span class="n">NaN</span>     <span class="n">d</span>     <span class="mi">30</span>

<span class="c1"># FULL OUTER JOIN
</span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span><span class="n">df2</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span> <span class="s">'outer'</span><span class="p">,</span> <span class="n">left_on</span> <span class="o">=</span> <span class="s">'col1'</span><span class="p">,</span> <span class="n">right_on</span> <span class="o">=</span> <span class="s">'col11'</span><span class="p">)</span>
<span class="n">Out</span><span class="p">:</span> 
  <span class="n">col1</span>  <span class="n">col2</span> <span class="n">col11</span>  <span class="n">col22</span>
<span class="mi">0</span>    <span class="n">a</span>   <span class="mf">1.0</span>     <span class="n">a</span>   <span class="mf">10.0</span>
<span class="mi">1</span>    <span class="n">b</span>   <span class="mf">2.0</span>     <span class="n">b</span>   <span class="mf">20.0</span>
<span class="mi">2</span>    <span class="n">c</span>   <span class="mf">3.0</span>   <span class="n">NaN</span>    <span class="n">NaN</span>
<span class="mi">3</span>  <span class="n">NaN</span>   <span class="n">NaN</span>     <span class="n">d</span>   <span class="mf">30.0</span>

<span class="c1"># INDEX로 JOIN
</span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span><span class="n">df2</span><span class="p">,</span> <span class="n">left_index</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">right_index</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">Out</span><span class="p">:</span> 
  <span class="n">col1</span>  <span class="n">col2</span> <span class="n">col11</span>  <span class="n">col22</span>
<span class="mi">0</span>    <span class="n">a</span>     <span class="mi">1</span>     <span class="n">a</span>     <span class="mi">10</span>
<span class="mi">1</span>    <span class="n">b</span>     <span class="mi">2</span>     <span class="n">b</span>     <span class="mi">20</span>
<span class="mi">2</span>    <span class="n">c</span>     <span class="mi">3</span>     <span class="n">d</span>     <span class="mi">30</span></code></pre></figure>

<hr />

<h3 id="pivot">4. 피벗 테이블(pivot)</h3>

<p>피벗 테이블 기능은 엑셀(MS Excel)에서도 제공하는 강력한 기능입니다. 데이터에 있는 정보들을 보기 좋게 요약해주는 기능인데 값들에 대하여 그룹함수도 사용할 수 있습니다. 피벗 테이블 메소드는 <code class="highlighter-rouge">pivot</code>과 <code class="highlighter-rouge">pivot_table</code>이 있는데 요약기능 여부의 차이가 있습니다. 그래서 교육받을 당시에는 요약기능이 있는 pivot_table 메소드를 많이 썼던 기억이 나네요.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1"># pivot 메소드
</span><span class="n">data</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span> <span class="o">=</span>  <span class="p">,</span> <span class="c1"># 인덱스에 넣을 컬럼명
</span>           <span class="n">columns</span><span class="o">=</span> <span class="p">,</span> <span class="c1"># 컬럼에 넣을 컬럼명
</span>           <span class="n">values</span> <span class="o">=</span> <span class="p">)</span> <span class="c1"># 값으로 정할 컬럼명
</span>
<span class="c1"># pivot_table 메소드
</span><span class="n">data</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span>  <span class="o">=</span> <span class="p">,</span>  <span class="c1"># 인덱스에 넣을 컬럼명
</span>                 <span class="n">columns</span><span class="o">=</span> <span class="p">,</span>  <span class="c1"># 컬럼에 넣을 컬럼명
</span>                 <span class="n">values</span> <span class="o">=</span> <span class="p">,</span>  <span class="c1"># 값으로 정할 컬럼명
</span>                 <span class="n">agg_func</span> <span class="o">=</span> <span class="s">'함수'</span><span class="p">)</span> <span class="c1"># 요약함수(sum, mean, count 등)</span></code></pre></figure>

<p>이제 예제를 통해 피벗 테이블 기능을 사용해봅시다. 파일은 저번 글에 첨부한 <code class="highlighter-rouge">subway2.csv</code>로 하겠습니다. 전처리는 되어 있다는 가정하에 진행하겠습니다.</p>

<p>예제) 인덱스에 전체를, 컬럼에 구분(승차/하차)을, 그리고 값에는 9시 시간대로 설정하여 피벗 테이블을 만드시오.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">data2</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span> <span class="o">=</span> <span class="s">'전체'</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="s">'구분'</span><span class="p">,</span> <span class="n">values</span> <span class="o">=</span> <span class="s">'9시'</span><span class="p">)</span></code></pre></figure>

<p>이런 식으로 하면 됩니다.</p>

<h3 id="panstr">5.str 모듈</h3>

<p>pandas 내부의 str 모듈은 문자열 처리 메소드를 가지고 있는데 벡터연산이 가능하여 원소마다 적용이 가능합니다.</p>

<p>1) split : 구분자를 기준으로 각 원소의 문자열을 나눕니다.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">s1</span><span class="o">.</span><span class="nb">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">';'</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">74</span><span class="p">]:</span> 
<span class="mi">0</span>    <span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">]</span>
<span class="mi">1</span>    <span class="p">[</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">]</span>
<span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span></code></pre></figure>

<dl>
  <dt>1-1) 특정 위치 색인</dt>
  <dd>
    <p>str.split으로 나눈 후 특정 위치의 원소를 색인하는 기능으로 두 가지 메소드가 있습니다.(기능은 동일)</p>
  </dd>
</dl>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">s1</span><span class="o">.</span><span class="nb">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">';'</span><span class="p">)</span><span class="o">.</span><span class="nb">str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">s1</span><span class="o">.</span><span class="nb">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">';'</span><span class="p">)</span><span class="o">.</span><span class="nb">str</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">Out</span><span class="p">:</span>
<span class="mi">0</span>    <span class="n">a</span>
<span class="mi">1</span>    <span class="n">A</span>
<span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span></code></pre></figure>

<p>2) replace : 각 원소 내의 문자중 첫 번째 인자를 두 번째 인자로 바꿉니다.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">s1</span><span class="o">.</span><span class="nb">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">';'</span><span class="p">,</span><span class="s">'|'</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">75</span><span class="p">]:</span> 
<span class="mi">0</span>    <span class="n">a</span><span class="o">|</span><span class="n">b</span><span class="o">|</span><span class="n">c</span>
<span class="mi">1</span>    <span class="n">A</span><span class="o">|</span><span class="n">B</span><span class="o">|</span><span class="n">C</span>
<span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span></code></pre></figure>

<p>​
3) 대소치환 : 대/소문자 치환 메소드입니다.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">s1</span><span class="o">.</span><span class="nb">str</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
<span class="n">Out</span><span class="p">:</span> 
<span class="mi">0</span>    <span class="n">A</span><span class="p">;</span><span class="n">B</span><span class="p">;</span><span class="n">C</span>
<span class="mi">1</span>    <span class="n">A</span><span class="p">;</span><span class="n">B</span><span class="p">;</span><span class="n">C</span>
<span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>

<span class="n">s1</span><span class="o">.</span><span class="nb">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
<span class="n">Out</span><span class="p">:</span> 
<span class="mi">0</span>    <span class="n">a</span><span class="p">;</span><span class="n">b</span><span class="p">;</span><span class="n">c</span>
<span class="mi">1</span>    <span class="n">a</span><span class="p">;</span><span class="n">b</span><span class="p">;</span><span class="n">c</span>
<span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>

<span class="n">s1</span><span class="o">.</span><span class="nb">str</span><span class="o">.</span><span class="n">title</span><span class="p">()</span> <span class="c1"># SQL의 INITCAP과 동일, 첫 글자만 대문자
</span><span class="n">Out</span><span class="p">:</span> 
<span class="mi">0</span>    <span class="n">A</span><span class="p">;</span><span class="n">B</span><span class="p">;</span><span class="n">C</span>
<span class="mi">1</span>    <span class="n">A</span><span class="p">;</span><span class="n">B</span><span class="p">;</span><span class="n">C</span>
<span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span></code></pre></figure>

<p>4) 패턴여부 : 입력한 문자가 존재하는지 여부</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1"># a로 시작하는지 여부
</span><span class="n">s1</span><span class="o">.</span><span class="nb">str</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">'a'</span><span class="p">)</span>
<span class="n">Out</span><span class="p">:</span> 
<span class="mi">0</span>     <span class="bp">True</span>
<span class="mi">1</span>    <span class="bp">False</span>
<span class="n">dtype</span><span class="p">:</span> <span class="nb">bool</span>

<span class="c1"># c로 끝나는지 여부
</span><span class="n">s1</span><span class="o">.</span><span class="nb">str</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s">'c'</span><span class="p">)</span>
<span class="n">Out</span><span class="p">:</span> 
<span class="mi">0</span>     <span class="bp">True</span>
<span class="mi">1</span>    <span class="bp">False</span>
<span class="n">dtype</span><span class="p">:</span> <span class="nb">bool</span>

<span class="c1"># a를 포함하는지 여부
</span><span class="n">s1</span><span class="o">.</span><span class="nb">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s">'a'</span><span class="p">)</span>
<span class="n">Out</span><span class="p">:</span> 
<span class="mi">0</span>     <span class="bp">True</span>
<span class="mi">1</span>    <span class="bp">False</span>
<span class="n">dtype</span><span class="p">:</span> <span class="nb">bool</span></code></pre></figure>

<p>5) 개수 및 길이</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1"># a가 몇 개 있는가
</span><span class="n">s1</span><span class="o">.</span><span class="nb">str</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s">'a'</span><span class="p">)</span>
<span class="n">Out</span><span class="p">:</span> 
<span class="mi">0</span>    <span class="mi">1</span>
<span class="mi">1</span>    <span class="mi">0</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>

<span class="c1"># 원소들의 글자의 갯수
</span><span class="n">s1</span><span class="o">.</span><span class="nb">str</span><span class="o">.</span><span class="nb">len</span><span class="p">()</span>
<span class="n">Out</span><span class="p">:</span> 
<span class="mi">0</span>    <span class="mi">5</span>
<span class="mi">1</span>    <span class="mi">5</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span></code></pre></figure>

<p>6) 제거함수 : 괄호 안 인자와 일치하는 문자 제거. 제거 방식은 replace 방식이 아니라 SQL의 TRIM과 같습니다. 기본 인자는 공백<code class="highlighter-rouge">' '</code>입니다.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1"># 좌우로 공백이 포함된 원소가 들어있는 새 시리즈 생성
</span><span class="n">s2</span> <span class="o">=</span><span class="n">Series</span><span class="p">([</span><span class="s">' ab '</span><span class="p">,</span><span class="s">' AB '</span><span class="p">])</span>
<span class="n">s2</span><span class="o">.</span><span class="nb">str</span><span class="o">.</span><span class="nb">len</span><span class="p">()</span>
<span class="n">Out</span><span class="p">:</span> 
<span class="mi">0</span>    <span class="mi">4</span>
<span class="mi">1</span>    <span class="mi">4</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
<span class="c1"># 양 옆 공백으로 인해 글자 길이가 4
</span>
<span class="c1"># 양쪽 공백 제거 후 길이
</span><span class="n">s2</span><span class="o">.</span><span class="nb">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="nb">str</span><span class="o">.</span><span class="nb">len</span><span class="p">()</span>
<span class="n">Out</span><span class="p">:</span> 
<span class="mi">0</span>    <span class="mi">2</span>
<span class="mi">1</span>    <span class="mi">2</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>

<span class="c1"># 오른쪽 공백 제거 후 길이
</span><span class="n">s2</span><span class="o">.</span><span class="nb">str</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="nb">str</span><span class="o">.</span><span class="nb">len</span><span class="p">()</span>
<span class="n">Out</span><span class="p">:</span> 
<span class="mi">0</span>    <span class="mi">3</span>
<span class="mi">1</span>    <span class="mi">3</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>

<span class="c1"># 왼쪽 공백 제거 후 길이
</span><span class="n">s2</span><span class="o">.</span><span class="nb">str</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s">'a'</span><span class="p">)</span>
<span class="n">Out</span><span class="p">:</span> 
<span class="mi">0</span>    <span class="mi">3</span>
<span class="mi">1</span>    <span class="mi">3</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span></code></pre></figure>

<hr />

<h3 id="dfdup">6. 중복 처리 메소드(duplicate)</h3>

<dl>
  <dt>1) duplicated</dt>
  <dd>
    <p>중복이면 True, 중복값이 없으면 False를 출력하는 메소드입니다.</p>
  </dd>
</dl>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1"># 시리즈 생성
</span><span class="n">s1</span> <span class="o">=</span> <span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>

<span class="c1"># duplicated 실행
</span><span class="n">s1</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span>
<span class="n">Out</span><span class="p">:</span> 
<span class="mi">0</span>    <span class="bp">False</span>
<span class="mi">1</span>     <span class="bp">True</span>
<span class="mi">2</span>    <span class="bp">False</span>
<span class="mi">3</span>    <span class="bp">False</span>
<span class="mi">4</span>    <span class="bp">False</span>
<span class="n">dtype</span><span class="p">:</span> <span class="nb">bool</span>

<span class="c1"># 메소드를 이용하여 중복인 값만 출력
</span><span class="n">s1</span><span class="p">[</span><span class="n">s1</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()]</span>
<span class="n">Out</span><span class="p">:</span> 
<span class="mi">1</span>    <span class="mi">1</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span></code></pre></figure>

<p>​</p>

<p>2) drop_duplicates</p>

<p>이전 key들중에서 중복된 값이 있는 경우 제외시키고 출력합니다. 데이터프레임에 사용시 옵션에 중복 제거를 실행할 컬럼을 지정할 수 있습니다.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1"># 시리즈에 적용
</span><span class="n">s1</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span> <span class="c1"># = s1[~s1.duplicated()]
</span><span class="n">Out</span><span class="p">:</span>
<span class="mi">0</span> <span class="mi">1</span>
<span class="mi">2</span> <span class="mi">2</span>
<span class="mi">3</span> <span class="mi">3</span>
<span class="mi">4</span> <span class="mi">4</span>

<span class="err">​</span><span class="c1"># 데이터 프레임에 적용
</span><span class="n">df1</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">({</span><span class="s">'col1'</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span>
                 <span class="s">'col2'</span><span class="p">:[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">]})</span>

<span class="c1"># 모든 컬럼이 중복인 행 제거
</span><span class="n">df1</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
<span class="n">Out</span><span class="p">:</span> 
   <span class="n">col1</span>  <span class="n">col2</span>
<span class="mi">0</span>     <span class="mi">1</span>     <span class="mi">5</span>
<span class="mi">1</span>     <span class="mi">1</span>     <span class="mi">6</span>
<span class="mi">2</span>     <span class="mi">2</span>     <span class="mi">7</span>
<span class="mi">3</span>     <span class="mi">3</span>     <span class="mi">7</span>
<span class="mi">4</span>     <span class="mi">4</span>     <span class="mi">8</span>

<span class="c1"># 'col' 컬럼이 중복인 행 제거
</span><span class="n">df1</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="s">'col1'</span><span class="p">)</span>
<span class="n">Out</span><span class="p">:</span> 
   <span class="n">col1</span>  <span class="n">col2</span>
<span class="mi">0</span>     <span class="mi">1</span>     <span class="mi">5</span>
<span class="mi">2</span>     <span class="mi">2</span>     <span class="mi">7</span>
<span class="mi">3</span>     <span class="mi">3</span>     <span class="mi">7</span>
<span class="mi">4</span>     <span class="mi">4</span>     <span class="mi">8</span></code></pre></figure>

<hr />

<p>python으로 할 수 있는 전처리는 거의 다 끝나갑니다. 다음 글에서는 구간 분할, 날짜 모듈과 그에 관련된 내용, groupby 등 이번 글에서 다루지 않은 내용이나 보다 심화된 내용을 다룰 예정입니다. R에 대한 내용까지 다룬 이후에는 모듈을 이용한 ML, DL 사용법, 글의 맞춤법 교정 및 난이도 조정이 계획되어 있습니다.</p>

</article>

<a href="#top">맨 위로</a>





<section class="rss">
  <p class="rss-subscribe text"><strong>Subscribe <a href="/feed.xml">via RSS</a></strong></p>
</section>

<section class="share">
  <span>Share: </span>
  
    
    
      <a href="//twitter.com/share?text=pandas+-+%EC%A0%84%EC%B2%98%EB%A6%AC+%EC%B6%94%EA%B0%80+%EB%82%B4%EC%9A%A9&url=http%3A%2F%2Flocalhost%3A4000%2Fpython%2F2020%2F09%2F28%2Fpython-df4.html&via="
        onclick="window.open(this.href, 'twitter-share', 'width=550,height=255');return false;">
        <i class="fa fa-twitter-square fa-lg"></i>
      </a>
    
    
    
    
    
    
    
  
    
    
    
      <a href="//www.facebook.com/sharer.php?t=pandas+-+%EC%A0%84%EC%B2%98%EB%A6%AC+%EC%B6%94%EA%B0%80+%EB%82%B4%EC%9A%A9&u=http%3A%2F%2Flocalhost%3A4000%2Fpython%2F2020%2F09%2F28%2Fpython-df4.html"
        onclick="window.open(this.href, 'facebook-share', 'width=550,height=255');return false;">
        <i class="fa fa-facebook-square fa-lg"></i>
      </a>
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
      <a href="//www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2Fpython%2F2020%2F09%2F28%2Fpython-df4.html"
        onclick="window.open(this.href, 'linkedin-share', 'width=550,height=255');return false;">
        <i class="fa fa-linkedin-square fa-lg"></i>
      </a>
    
    
    
    
  
    
    
    
    
      <a href="//plus.google.com/share?title=pandas+-+%EC%A0%84%EC%B2%98%EB%A6%AC+%EC%B6%94%EA%B0%80+%EB%82%B4%EC%9A%A9&url=http%3A%2F%2Flocalhost%3A4000%2Fpython%2F2020%2F09%2F28%2Fpython-df4.html"
        onclick="window.open(this.href, 'google-plus-share', 'width=550,height=255');return false;">
        <i class="fa fa-google-plus-square fa-lg"></i>
      </a>
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
      <a href="//www.pinterest.com/pin/create/button/?description=pandas+-+%EC%A0%84%EC%B2%98%EB%A6%AC+%EC%B6%94%EA%B0%80+%EB%82%B4%EC%9A%A9&url=http%3A%2F%2Flocalhost%3A4000%2Fpython%2F2020%2F09%2F28%2Fpython-df4.html&media=http://localhost:4000/assets/header_image.jpg"
        onclick="window.open(this.href, 'pinterest-share', 'width=550,height=255');return false;">
        <i class="fa fa-pinterest-square fa-lg"></i>
      </a>
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
      <a href="//www.reddit.com/submit" onclick="window.location = '//www.reddit.com/submit?url=' + encodeURIComponent('http://localhost:4000/python/2020/09/28/python-df4.html') + '&title=pandas - 전처리 추가 내용'; return false">
        <i class="fa fa-reddit-square fa-lg"></i>
      </a>
    
    
  
    
    
    
    
    
    
    
    
  
</section>




</div>
</div>

    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h3 class="footer-heading">RWDR</h3>

    <div class="site-navigation">

      <p><strong>Site Map</strong></p>
      <ul class="pages">
				
	
	<li class="nav-link"><a href="/about/">About</a>
	

	

	

	
	<li class="nav-link"><a href="/posts/">Posts</a>
	

	

	
	<li class="nav-link"><a href="/search/">Search</a>
	

	
	<li class="nav-link"><a href="/typography/">Plan</a>
	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	


      </ul>
    </div>

    <div class="site-contact">

      <p><strong>Contact</strong></p>
      <ul class="social-media-list">
        <li>
          <a href="mailto:enne123@naver.com">
            <i class="fa fa-envelope-o"></i>
            <span class="username">enne123@naver.com</span>
          </a>
        </li>

        
          
        
          
        
          
          <li>
            <a href="https://github.com/Ring-wdr" title="Fork me on GitHub">
              <i class="fa fa-github"></i>
              <span class="username">Ring-wdr</span>
            </a>
          </li>
          
        
          
        
          
        
          
        
          
          <li>
            <a href="https://www.instagram.com/kim.manjoong" title="Follow me on Instagram">
              <i class="fa fa-instagram"></i>
              <span class="username">kim.manjoong</span>
            </a>
          </li>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        

      </ul>
    </div>

    <div class="site-signature">
      <p class="rss-subscribe text"><strong>Subscribe <a href="/feed.xml">via RSS</a></strong></p>
      <p class="text">A simple blog.
</p>
    </div>

  </div>

</footer>

<!-- Scripts -->
<script src="//code.jquery.com/jquery-3.4.1.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/lightbox2/2.11.1/js/lightbox.min.js"></script>
<script src="//unpkg.com/popper.js@1"></script>
<script src="//unpkg.com/tippy.js@5"></script>

<script type="text/javascript">
$(document).ready(function() {
  // Default syntax highlighting
  hljs.initHighlightingOnLoad();

  // Header
  var menuToggle = $('#js-mobile-menu').unbind();
  $('#js-navigation-menu').removeClass("show");
  menuToggle.on('click', function(e) {
    e.preventDefault();
    $('#js-navigation-menu').slideToggle(function(){
      if($('#js-navigation-menu').is(':hidden')) {
        $('#js-navigation-menu').removeAttr('style');
      }
    });
  });

	// Enable tooltips via Tippy.js
	if (Array.isArray(window.tooltips)) {
		window.tooltips.forEach(function(tooltip) {
			var selector = tooltip[0];
			var config = tooltip[1];
			tippy(selector, config);
		})
	}
});

</script>




<!-- Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'G-LYEK3M0XH1', 'auto');
  ga('send', 'pageview', {
    'page': '/python/2020/09/28/python-df4.html',
    'title': 'pandas - 전처리 추가 내용'
  });
</script>



  </body>

</html>
