<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>더미 데이터 생성</title>
  <meta name="description" content="목차">
  
  <meta name="author" content="Manjoong Kim">
  <meta name="copyright" content="&copy; Manjoong Kim 2020">
  

  <!-- External libraries -->
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/monokai-sublime.min.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/lightbox2/2.7.1/css/lightbox.css">

  <!-- Favicon and other icons (made with http://www.favicon-generator.org/) -->
  <link rel="shortcut icon" href="/assets/icons/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/assets/icons/favicon.ico" type="image/x-icon">
  <link rel="apple-touch-icon" sizes="57x57" href="/assets/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/assets/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/assets/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/assets/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/assets/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/assets/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/assets/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/assets/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="/assets/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/assets/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/icons/favicon-16x16.png">
  <link rel="manifest" href="/assets/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/assets/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">

  
  <!-- Facebook OGP cards -->
  <meta property="og:description" content="목차" />
  <meta property="og:url" content="http://localhost:4000/python/2020/11/12/python-dumdata.html">
  <meta property="og:site_name" content="RWDR" />
  <meta property="og:title" content="더미 데이터 생성" />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="http://localhost:4000/assets/RWDR.png" />
  <meta property="og:image:type" content="image/png" />
  <meta property="og:image:width" content="612" />
  <meta property="og:image:height" content="605" />
  

  
  <!-- Twitter: card tags -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="더미 데이터 생성">
  <meta name="twitter:description" content="목차">
  <meta name="twitter:image" content="http://localhost:4000/assets/RWDR.png">
  <meta name="twitter:url" content="http://localhost:4000/python/2020/11/12/python-dumdata.html">
  

  

  <!-- Site styles -->
  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://localhost:4000/python/2020/11/12/python-dumdata.html">
	<link rel="alternate" type="application/rss+xml" title="RWDR" href="http://localhost:4000/feed.xml" />
	
	<!-- Tooltips -->
	<script type="text/javascript">
		window.tooltips = []
	</script>
</head>


  <body>

    <header class="navigation" role="banner">
  <div class="navigation-wrapper">
    <a href="/" class="logo">
      
      <img src="/assets/RWDR.png" alt="RWDR">
      
    </a>
    <a href="javascript:void(0)" class="navigation-menu-button" id="js-mobile-menu">
      <i class="fa fa-bars"></i>
    </a>
    <nav role="navigation">
      <ul id="js-navigation-menu" class="navigation-menu show">
				
	
	<li class="nav-link"><a href="/about/">About</a>
	

	

	

	
	<li class="nav-link"><a href="/posts/">Posts</a>
	

	

	
	<li class="nav-link"><a href="/search/">Search</a>
	

	
	<li class="nav-link"><a href="/typography/">Plan</a>
	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	


      </ul>
    </nav>
  </div>
</header>


    <div class="page-content">
        <div class="post">

<div class="post-header-container " >
  <div class="scrim ">
    <header class="post-header">
      <h1 class="title">더미 데이터 생성</h1>
      <p class="info">by <strong>Kim</strong></p>
    </header>
  </div>
</div>

<div class="wrapper">

 <span class="page-divider">
  <span class="one"></span>
  <span class="two"></span>
</span>
 

<section class="post-meta">
  <div class="post-date">November 12, 2020</div>
  <div class="post-categories">
  in 
    
    <a href="/category/python">Python</a>
    
  
  </div>
</section>

<article class="post-content">
  <h2 id="목차">목차</h2>

<ul>
  <li><a href="#grammar">0. 쇼핑몰 설정 주 사용 함수</a></li>
  <li><a href="#cust">1. 고객 테이블(customer))</a></li>
  <li><a href="#product">2. 상품 테이블(product)</a></li>
  <li><a href="#order">3. 주문 테이블(order)</a></li>
  <li><a href="#orderitem">4. 주문한 상품 테이블(order_item)</a></li>
  <li><a href="#prepr">5. 전처리(preprocess)</a></li>
</ul>

<p>가상의 쇼핑몰을 분석 하기 위해 더미 데이터를 만들어 보았습니다. 랜덤 함수를 사용하기 때문에 실질적인 인사이트를 도출하기에는 어렵겠지만 국내 오픈마켓 매장 데이터를 구하기 어렵기 때문에 캐글에 공개되어 있는 해외 스토어 <a href="https://www.kaggle.com/olistbr/brazilian-ecommerce?select=olist_order_items_dataset.csv">Olist Store</a>의 데이터의 구조를 참고하여 필요한 컬럼만 만들었습니다.</p>

<p><br /></p>

<hr />

<h2 id="grammar">0. 기초 설정 및 주 사용함수</h2>

<p>프로젝트의 쇼핑몰 설정은 이렇습니다.</p>

<table>
  <thead>
    <tr>
      <th>이름</th>
      <th>내용</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>기간</td>
      <td>2년(‘18~’19년도 주문내역)</td>
    </tr>
    <tr>
      <td>회원</td>
      <td>약 10만명 + (비회원 @)</td>
    </tr>
    <tr>
      <td>지역 개수</td>
      <td>25 (based on 서울시 구)</td>
    </tr>
    <tr>
      <td>주문</td>
      <td>50만건</td>
    </tr>
    <tr>
      <td>상품</td>
      <td>500가지</td>
    </tr>
    <tr>
      <td>성비(남녀)</td>
      <td>3:7</td>
    </tr>
    <tr>
      <td>연령대<br />(10대: 20~30대:<br />40~50대: 60대 이상)</td>
      <td>5:45:45:5</td>
    </tr>
    <tr>
      <td>가구형태 1 <br />(독신:2인이상)</td>
      <td>35:65</td>
    </tr>
    <tr>
      <td>가구형태 2 <br />(미혼:기혼)</td>
      <td>50:50</td>
    </tr>
    <tr>
      <td>가구형태 3<br />(자녀 유:자녀 무)</td>
      <td>7:3</td>
    </tr>
    <tr>
      <td>쇼핑몰 내 등록된 제품 출시일</td>
      <td>2015.01.01~</td>
    </tr>
  </tbody>
</table>

<p><br /></p>

<p>사용할 라이브러리</p>

<p>​</p>
<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">DataFrame</span>
<span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">Series</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">timedelta</span></code></pre></figure>

<p>라이브러리를 다 불러와야 본문의 함수들을 사용할 수 있습니다.</p>

<p>주로 사용할 함수는 랜덤 생성 함수입니다.</p>

<p>​</p>
<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1">#임의로 표본 추출
</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">low</span><span class="p">,</span>  <span class="c1"># 시작값
</span>               <span class="n">high</span><span class="p">)</span> <span class="c1"># 끝값
</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">low</span><span class="p">,</span>  <span class="c1"># 시작값
</span>                  <span class="n">high</span><span class="p">,</span> <span class="c1"># 끝값
</span>                  <span class="n">size</span><span class="p">)</span> <span class="c1"># 표본 사이즈
</span>
<span class="c1">#원소별 가중치 부여 후 추출
</span><span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="n">population</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="c1"># 표본
</span>               <span class="n">weights</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span>   <span class="c1"># 가중치
</span>               <span class="n">k</span> <span class="o">=</span> <span class="n">n</span><span class="p">)</span> <span class="c1"># 추출 갯수</span></code></pre></figure>

<p><br /></p>

<hr />

<h2 id="cust">1. 고객 테이블(customer)</h2>

<table>
  <thead>
    <tr>
      <th>이름</th>
      <th>형식</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>회원</td>
      <td>0 ~ 99441</td>
    </tr>
    <tr>
      <td>지역 개수</td>
      <td>0 ~ 24</td>
    </tr>
    <tr>
      <td>성별</td>
      <td>남여 : 1/2</td>
    </tr>
    <tr>
      <td>연령대</td>
      <td>10대:1, 20~30대:2<br />40~50대:3, 60대 이상:4)</td>
    </tr>
    <tr>
      <td>가구형태 1</td>
      <td>독신여부 : 1/2</td>
    </tr>
    <tr>
      <td>가구형태 2</td>
      <td>결혼여부 : 1/2</td>
    </tr>
    <tr>
      <td>가구형태 3</td>
      <td>자녀여부 : 1/2</td>
    </tr>
  </tbody>
</table>

<h3 id="cust1">파일 불러오기 및 확인</h3>

<p>​</p>
<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1">#캐글 데이터 파일 불러오기
</span><span class="n">customer</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'olist_customers_dataset.csv'</span><span class="p">,</span> <span class="n">engine</span> <span class="o">=</span> <span class="s">'python'</span><span class="p">)</span>
<span class="c1">#컬럼 이름 확인
</span><span class="n">customer</span><span class="o">.</span><span class="n">columns</span>  
<span class="c1">#컬럼 이름 수정
</span><span class="n">customer</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">'customer_id'</span><span class="p">,</span> <span class="s">'customer_unique_id'</span><span class="p">,</span> <span class="s">'customer_zip_code_prefix'</span><span class="p">,</span> <span class="s">'gu'</span><span class="p">,</span> <span class="s">'customer_state'</span><span class="p">]</span></code></pre></figure>

<h3 id="cust2">더미 데이터 생성</h3>

<p>​</p>
<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1">#고객번호를 처음부터 끝까지 순서대로 부여
</span><span class="n">customer</span><span class="p">[</span><span class="s">'customer_id'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">customer</span><span class="p">))]</span>

<span class="c1">#지역 입력
</span><span class="n">gu_list</span><span class="o">=</span><span class="p">[</span><span class="mi">1111000000</span><span class="p">,</span><span class="mi">1114000000</span><span class="p">,</span><span class="mi">1117000000</span><span class="p">,</span><span class="mi">1120000000</span><span class="p">,</span><span class="mi">1121500000</span><span class="p">,</span>
         <span class="mi">1123000000</span><span class="p">,</span><span class="mi">1126000000</span><span class="p">,</span><span class="mi">1129000000</span><span class="p">,</span><span class="mi">1130500000</span><span class="p">,</span><span class="mi">1132000000</span><span class="p">,</span>
         <span class="mi">1135000000</span><span class="p">,</span><span class="mi">1138000000</span><span class="p">,</span><span class="mi">1141000000</span><span class="p">,</span><span class="mi">1144000000</span><span class="p">,</span><span class="mi">1147000000</span><span class="p">,</span>
         <span class="mi">1150000000</span><span class="p">,</span><span class="mi">1153000000</span><span class="p">,</span><span class="mi">1154500000</span><span class="p">,</span><span class="mi">1156000000</span><span class="p">,</span><span class="mi">1159000000</span><span class="p">,</span>
         <span class="mi">1162000000</span><span class="p">,</span><span class="mi">1165000000</span><span class="p">,</span><span class="mi">1168000000</span><span class="p">,</span><span class="mi">1171000000</span><span class="p">,</span><span class="mi">1174000000</span><span class="p">]</span>
<span class="n">customer</span><span class="p">[</span><span class="s">'gu_code'</span><span class="p">]</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="n">population</span><span class="o">=</span><span class="n">gu_list</span><span class="p">,</span>
                                     <span class="n">k</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">customer</span><span class="p">))</span>

<span class="c1">#나이
</span><span class="n">customer</span><span class="p">[</span><span class="s">'age'</span><span class="p">]</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="n">population</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span>
                                 <span class="n">weights</span><span class="o">=</span><span class="p">[</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.45</span><span class="p">,</span><span class="mf">0.45</span><span class="p">,</span><span class="mf">0.05</span><span class="p">],</span>
                                 <span class="n">k</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">customer</span><span class="p">))</span>

<span class="c1">#성별 및 가구형태
</span><span class="n">customer</span><span class="p">[</span><span class="s">'gender'</span><span class="p">]</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="n">population</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
                                    <span class="n">weights</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span>
                                    <span class="n">k</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">customer</span><span class="p">))</span>
<span class="n">customer</span><span class="p">[</span><span class="s">'household'</span><span class="p">]</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="n">population</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
                                    <span class="n">weights</span><span class="o">=</span><span class="p">[</span><span class="mf">0.35</span><span class="p">,</span><span class="mf">0.65</span><span class="p">],</span>
                                    <span class="n">k</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">customer</span><span class="p">))</span>
<span class="n">customer</span><span class="p">[</span><span class="s">'marriage'</span><span class="p">]</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="n">population</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
                                    <span class="n">k</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">customer</span><span class="p">))</span>
<span class="n">customer</span><span class="p">[</span><span class="s">'children'</span><span class="p">]</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="n">population</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
                                    <span class="n">weights</span><span class="o">=</span><span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span>
                                    <span class="n">k</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">customer</span><span class="p">))</span>

<span class="c1">#csv 파일로 내보내기
</span><span class="n">customer</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">'customer_table.csv'</span><span class="p">,</span> <span class="n">encoding</span> <span class="o">=</span> <span class="s">'utf-8-sig'</span><span class="p">,</span>
                <span class="n">index</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span></code></pre></figure>

<p><br /></p>

<hr />

<h2 id="product">2. 상품 테이블(product)</h2>

<table>
  <thead>
    <tr>
      <th>이름</th>
      <th>내용</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>상품</td>
      <td>500가지</td>
    </tr>
    <tr>
      <td>가격</td>
      <td>2300 ~ 23000원</td>
    </tr>
    <tr>
      <td>제품 출시일</td>
      <td>2015.01.01 이후</td>
    </tr>
  </tbody>
</table>

<p>​</p>
<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1">#날짜 생성 사용자 함수
</span><span class="k">def</span> <span class="nf">random_dates</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">start_u</span> <span class="o">=</span> <span class="n">start</span><span class="o">.</span><span class="n">value</span><span class="o">//</span><span class="mi">10</span><span class="o">**</span><span class="mi">9</span>
    <span class="n">end_u</span> <span class="o">=</span> <span class="n">end</span><span class="o">.</span><span class="n">value</span><span class="o">//</span><span class="mi">10</span><span class="o">**</span><span class="mi">9</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">start_u</span><span class="p">,</span> <span class="n">end_u</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">unit</span><span class="o">=</span><span class="s">'s'</span><span class="p">)</span>

<span class="c1">#기간의 시작과 끝 지정
</span><span class="n">start</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s">'2015-01-01'</span><span class="p">)</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s">'2019-12-31'</span><span class="p">)</span>

<span class="c1">#테이블 생성
</span><span class="n">products</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">({</span><span class="s">'product_id'</span><span class="p">:[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">500</span><span class="p">)],</span>
                      <span class="s">'product_release'</span><span class="p">:</span> <span class="n">random_dates</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">500</span><span class="p">),</span>
                      <span class="s">'price'</span><span class="p">:[</span><span class="n">f</span><span class="s">'{random.randrange(23,230)}00'</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">500</span><span class="p">]</span>
                     <span class="p">}</span>
                    <span class="p">)</span>

<span class="c1">#csv 파일로 저장
</span><span class="n">products</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">'product.csv'</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span></code></pre></figure>

<p><br /></p>

<hr />

<h2 id="order">3. 주문 테이블(order)</h2>

<table>
  <thead>
    <tr>
      <th>이름</th>
      <th>내용</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>주문건수</td>
      <td>50만번</td>
    </tr>
    <tr>
      <td>회원</td>
      <td>약 10만명</td>
    </tr>
    <tr>
      <td>기간</td>
      <td>2년(‘18~’19년도 주문내역)</td>
    </tr>
  </tbody>
</table>

<p>​</p>
<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1">#상품 테이블에서 사용한 날짜 생성 사용자 함수 불러오기
</span>
<span class="c1">#주문 기간 설정
</span><span class="n">start_2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s">'2018-01-01'</span><span class="p">)</span>
<span class="n">end_2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s">'2019-12-31'</span><span class="p">)</span>

<span class="c1">#주문번호 및 고객번호 입력
</span><span class="n">orders</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">({</span><span class="s">'order_id'</span><span class="p">:[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">500000</span><span class="p">)],</span>
                    <span class="s">'customer_id'</span><span class="p">:[</span><span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">99441</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">500000</span><span class="p">)]})</span>

<span class="n">timestamp</span> <span class="o">=</span> <span class="n">Series</span><span class="p">(</span><span class="n">random_dates</span><span class="p">(</span><span class="n">start_2</span><span class="p">,</span> <span class="n">end_2</span><span class="p">,</span> <span class="mi">500000</span><span class="p">))</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span>
<span class="n">timestamp</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">500000</span><span class="p">)]</span>
<span class="n">orders</span><span class="p">[</span><span class="s">'order_purchase_time_stamp'</span><span class="p">]</span> <span class="o">=</span> <span class="n">timestamp</span>

<span class="c1">#csv 파일로 저장
</span><span class="n">orders</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">'order.csv'</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span></code></pre></figure>

<p><br /></p>

<hr />

<h2 id="orderitem">4. 주문한 상품 테이블(order_item)</h2>

<table>
  <thead>
    <tr>
      <th>이름</th>
      <th>내용</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>주문건수</td>
      <td>50만번</td>
    </tr>
    <tr>
      <td>주문당 상품 수</td>
      <td>1~8 (1개가 대부분)</td>
    </tr>
    <tr>
      <td>상품</td>
      <td>500가지</td>
    </tr>
    <tr>
      <td>갯수</td>
      <td>1~4 (1개가 대부분)</td>
    </tr>
  </tbody>
</table>

<p>​</p>
<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1">#주문건수와 주문당 상품 수 수정가능한 사용자 정의 함수
</span><span class="k">def</span> <span class="nf">order_n_num_2</span><span class="p">(</span><span class="n">ord_range</span><span class="p">,</span> <span class="n">list_range</span><span class="p">):</span>
    <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="nb">list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">list_range</span><span class="p">),</span>
                            <span class="n">weights</span><span class="o">=</span><span class="p">[</span><span class="mf">0.9</span> <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="mi">0</span> <span class="k">else</span> <span class="mf">0.05</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">list_range</span><span class="p">)],</span>
                            <span class="n">k</span><span class="o">=</span><span class="n">ord_range</span><span class="p">):</span>
        <span class="n">ran_list</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">500</span><span class="p">),</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="nb">list</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">start</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">ran_list</span><span class="p">[</span><span class="n">j</span><span class="p">]])</span>
        <span class="n">start</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="nb">list</span>
    
<span class="n">fin_list</span> <span class="o">=</span> <span class="n">order_n_num_2</span><span class="p">(</span><span class="mi">500000</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">data4</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">fin_list</span><span class="p">)</span>
<span class="n">data4</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">'order_id'</span><span class="p">,</span><span class="s">'order_items_id'</span><span class="p">,</span><span class="s">'product_id'</span><span class="p">]</span>

<span class="c1">#수량은 임의대로 생성
</span><span class="n">data4</span><span class="p">[</span><span class="s">'quantity'</span><span class="p">]</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="n">population</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="n">weights</span><span class="o">=</span><span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">k</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">data4</span><span class="p">))</span>

<span class="c1">#csv 파일로 저장
</span><span class="n">data4</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">'order_item.csv'</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span></code></pre></figure>

<p><br /></p>

<hr />

<h2 id="prepr">5. 전처리(preprocess)</h2>

<p>제품 출시일보다 주문날짜가 앞이면 논리적으로 앞뒤가 맞지 않기 때문에 제품 출시일보다 주문날짜가 앞인경우 제품 출시일을 주문날짜 며칠 전으로 바꿔주는 과정입니다. 실제 데이터라면 결측치로 처리하거나 다른 방법을 알아보겠지만 직접 만드는 데이터기 때문에 수정을 하도록 하겠습니다.</p>

<p>​</p>
<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1">#3개 csv 파일 불러오기
</span><span class="n">order</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'order.csv'</span><span class="p">)</span>
<span class="n">product</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'product.csv'</span><span class="p">)</span>
<span class="n">order_item</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'order_item.csv'</span><span class="p">)</span>

<span class="c1">#LEFT JOIN 실행
</span><span class="n">order_mg</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="n">order_item</span><span class="p">,</span> <span class="n">on</span> <span class="o">=</span> <span class="s">'order_id'</span><span class="p">)</span>

<span class="c1">#상품별 최초 주문일 가져오기
</span><span class="n">order_mg_2</span> <span class="o">=</span> <span class="n">order_mg</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'product_id'</span><span class="p">)[</span><span class="s">'order_purchase_time_stamp'</span><span class="p">]</span><span class="o">.</span><span class="nb">min</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="c1">#데이터 타입 확인
</span><span class="n">order_mg_2</span><span class="o">.</span><span class="n">dtypes</span>
<span class="n">product</span><span class="o">.</span><span class="n">dtypes</span>

<span class="c1">#상품별 최초 주문일의 데이터 타입을 날짜 형식으로 변경
</span><span class="n">order_mg_2</span><span class="p">[</span><span class="s">'order_purchase_time_stamp'</span><span class="p">]</span> <span class="o">=</span> <span class="n">order_mg_2</span><span class="p">[</span><span class="s">'order_purchase_time_stamp'</span><span class="p">]</span><span class="o">.</span><span class="nb">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">_</span><span class="p">,</span><span class="s">"</span><span class="si">%</span><span class="s">Y-</span><span class="si">%</span><span class="s">m-</span><span class="si">%</span><span class="s">d </span><span class="si">%</span><span class="s">H:</span><span class="si">%</span><span class="s">M:</span><span class="si">%</span><span class="s">S"</span><span class="p">))</span>
<span class="n">product</span><span class="p">[</span><span class="s">'product_release'</span><span class="p">]</span> <span class="o">=</span> <span class="n">product</span><span class="p">[</span><span class="s">'product_release'</span><span class="p">]</span><span class="o">.</span><span class="nb">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">_</span><span class="p">,</span><span class="s">"</span><span class="si">%</span><span class="s">Y-</span><span class="si">%</span><span class="s">m-</span><span class="si">%</span><span class="s">d"</span><span class="p">))</span>

<span class="c1">#본문 내용의 전처리
</span><span class="n">product</span><span class="p">[</span><span class="s">'product_release'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">product</span><span class="p">[</span><span class="s">'product_release'</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
 <span class="k">if</span> <span class="n">product</span><span class="p">[</span><span class="s">'product_release'</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">order_mg_2</span><span class="p">[</span><span class="s">'order_purchase_time_stamp'</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
 <span class="k">else</span> <span class="n">order_mg_2</span><span class="p">[</span><span class="s">'order_purchase_time_stamp'</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">500</span><span class="p">)]</span>

<span class="c1">#csv 파일로 저장
</span><span class="n">product</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">'product_2.csv'</span><span class="p">)</span></code></pre></figure>


</article>

<a href="#top">맨 위로</a>





<section class="rss">
  <p class="rss-subscribe text"><strong>Subscribe <a href="/feed.xml">via RSS</a></strong></p>
</section>

<section class="share">
  <span>Share: </span>
  
    
    
      <a href="//twitter.com/share?text=%EB%8D%94%EB%AF%B8+%EB%8D%B0%EC%9D%B4%ED%84%B0+%EC%83%9D%EC%84%B1&url=http%3A%2F%2Flocalhost%3A4000%2Fpython%2F2020%2F11%2F12%2Fpython-dumdata.html&via="
        onclick="window.open(this.href, 'twitter-share', 'width=550,height=255');return false;">
        <i class="fa fa-twitter-square fa-lg"></i>
      </a>
    
    
    
    
    
    
    
  
    
    
    
      <a href="//www.facebook.com/sharer.php?t=%EB%8D%94%EB%AF%B8+%EB%8D%B0%EC%9D%B4%ED%84%B0+%EC%83%9D%EC%84%B1&u=http%3A%2F%2Flocalhost%3A4000%2Fpython%2F2020%2F11%2F12%2Fpython-dumdata.html"
        onclick="window.open(this.href, 'facebook-share', 'width=550,height=255');return false;">
        <i class="fa fa-facebook-square fa-lg"></i>
      </a>
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
      <a href="//www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2Fpython%2F2020%2F11%2F12%2Fpython-dumdata.html"
        onclick="window.open(this.href, 'linkedin-share', 'width=550,height=255');return false;">
        <i class="fa fa-linkedin-square fa-lg"></i>
      </a>
    
    
    
    
  
    
    
    
    
      <a href="//plus.google.com/share?title=%EB%8D%94%EB%AF%B8+%EB%8D%B0%EC%9D%B4%ED%84%B0+%EC%83%9D%EC%84%B1&url=http%3A%2F%2Flocalhost%3A4000%2Fpython%2F2020%2F11%2F12%2Fpython-dumdata.html"
        onclick="window.open(this.href, 'google-plus-share', 'width=550,height=255');return false;">
        <i class="fa fa-google-plus-square fa-lg"></i>
      </a>
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
      <a href="//www.pinterest.com/pin/create/button/?description=%EB%8D%94%EB%AF%B8+%EB%8D%B0%EC%9D%B4%ED%84%B0+%EC%83%9D%EC%84%B1&url=http%3A%2F%2Flocalhost%3A4000%2Fpython%2F2020%2F11%2F12%2Fpython-dumdata.html&media=http://localhost:4000/assets/header_image.jpg"
        onclick="window.open(this.href, 'pinterest-share', 'width=550,height=255');return false;">
        <i class="fa fa-pinterest-square fa-lg"></i>
      </a>
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
      <a href="//www.reddit.com/submit" onclick="window.location = '//www.reddit.com/submit?url=' + encodeURIComponent('http://localhost:4000/python/2020/11/12/python-dumdata.html') + '&title=더미 데이터 생성'; return false">
        <i class="fa fa-reddit-square fa-lg"></i>
      </a>
    
    
  
    
    
    
    
    
    
    
    
  
</section>




</div>
</div>

    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h3 class="footer-heading">RWDR</h3>

    <div class="site-navigation">

      <p><strong>Site Map</strong></p>
      <ul class="pages">
				
	
	<li class="nav-link"><a href="/about/">About</a>
	

	

	

	
	<li class="nav-link"><a href="/posts/">Posts</a>
	

	

	
	<li class="nav-link"><a href="/search/">Search</a>
	

	
	<li class="nav-link"><a href="/typography/">Plan</a>
	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	


      </ul>
    </div>

    <div class="site-contact">

      <p><strong>Contact</strong></p>
      <ul class="social-media-list">
        <li>
          <a href="mailto:enne123@naver.com">
            <i class="fa fa-envelope-o"></i>
            <span class="username">enne123@naver.com</span>
          </a>
        </li>

        
          
        
          
        
          
          <li>
            <a href="https://github.com/Ring-wdr" title="Fork me on GitHub">
              <i class="fa fa-github"></i>
              <span class="username">Ring-wdr</span>
            </a>
          </li>
          
        
          
        
          
        
          
        
          
          <li>
            <a href="https://www.instagram.com/kim.manjoong" title="Follow me on Instagram">
              <i class="fa fa-instagram"></i>
              <span class="username">kim.manjoong</span>
            </a>
          </li>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        

      </ul>
    </div>

    <div class="site-signature">
      <p class="rss-subscribe text"><strong>Subscribe <a href="/feed.xml">via RSS</a></strong></p>
      <p class="text">A simple blog.
</p>
    </div>

  </div>

</footer>

<!-- Scripts -->
<script src="//code.jquery.com/jquery-3.4.1.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/lightbox2/2.11.1/js/lightbox.min.js"></script>
<script src="//unpkg.com/popper.js@1"></script>
<script src="//unpkg.com/tippy.js@5"></script>

<script type="text/javascript">
$(document).ready(function() {
  // Default syntax highlighting
  hljs.initHighlightingOnLoad();

  // Header
  var menuToggle = $('#js-mobile-menu').unbind();
  $('#js-navigation-menu').removeClass("show");
  menuToggle.on('click', function(e) {
    e.preventDefault();
    $('#js-navigation-menu').slideToggle(function(){
      if($('#js-navigation-menu').is(':hidden')) {
        $('#js-navigation-menu').removeAttr('style');
      }
    });
  });

	// Enable tooltips via Tippy.js
	if (Array.isArray(window.tooltips)) {
		window.tooltips.forEach(function(tooltip) {
			var selector = tooltip[0];
			var config = tooltip[1];
			tippy(selector, config);
		})
	}
});

</script>






  </body>

</html>
